# å¤´åƒä¸Šä¼ åŠŸèƒ½é…ç½®æŒ‡å—

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

1. âœ… å¤´åƒä¸Šä¼ åŠŸèƒ½ï¼ˆæ”¯æŒ JPGã€PNGã€WEBPï¼Œæœ€å¤§ 2MBï¼‰
2. âœ… ä¿®æ”¹å¯†ç åŠŸèƒ½ï¼ˆéªŒè¯æ—§å¯†ç  + è®¾ç½®æ–°å¯†ç ï¼‰
3. âœ… ä¸ªäººä¿¡æ¯ç¼–è¾‘
4. âœ… ç¾è§‚çš„ UI äº¤äº’

---

## ğŸ”§ Supabase Storage é…ç½®æ­¥éª¤

### æ­¥éª¤ 1ï¼šåˆ›å»ºå­˜å‚¨æ¡¶ï¼ˆBucketï¼‰

1. **ç™»å½• Supabase Dashboard**
   - è®¿é—®ï¼šhttps://supabase.com/dashboard
   - æ‰¾åˆ°ä½ çš„é¡¹ç›®ï¼ˆURL: `vktkexyetdxcfdixfmmg.supabase.co`ï¼‰

2. **è¿›å…¥ Storage é¡µé¢**
   ```
   å·¦ä¾§èœå• â†’ Storage â†’ Buckets
   ```

3. **åˆ›å»ºæ–°çš„å­˜å‚¨æ¡¶**
   - ç‚¹å‡» **"New bucket"** æŒ‰é’®
   - **Bucket name**: `avatars`
   - **Public bucket**: âœ… **å‹¾é€‰æ­¤é¡¹**ï¼ˆè®¾ç½®ä¸ºå…¬å¼€è®¿é—®ï¼‰
   - ç‚¹å‡» **"Create bucket"**

---

### æ­¥éª¤ 2ï¼šè®¾ç½®å­˜å‚¨ç­–ç•¥ï¼ˆPoliciesï¼‰

åˆ›å»ºå­˜å‚¨æ¡¶åï¼Œéœ€è¦è®¾ç½®è®¿é—®ç­–ç•¥ä»¥å…è®¸ç”¨æˆ·ä¸Šä¼ å’Œè®¿é—®å¤´åƒã€‚

#### æ–¹æ³• Aï¼šåœ¨ Dashboard ä¸­åˆ›å»ºç­–ç•¥

1. **è¿›å…¥ Storage Policies**
   ```
   Storage â†’ Buckets â†’ avatars â†’ Policies
   ```

2. **åˆ›å»ºä¸Šä¼ ç­–ç•¥ï¼ˆUpload Policyï¼‰**
   - ç‚¹å‡» **"New Policy"** â†’ **"For full customization"**
   - **Policy name**: `Allow authenticated users to upload avatars`
   - **Allowed operation**: âœ… `INSERT`
   - **Policy definition**:
     ```sql
     (bucket_id = 'avatars'::text) AND (auth.role() = 'authenticated'::text)
     ```
   - ç‚¹å‡» **"Review"** â†’ **"Save policy"**

3. **åˆ›å»ºè¯»å–ç­–ç•¥ï¼ˆRead Policyï¼‰**
   - ç‚¹å‡» **"New Policy"** â†’ **"For full customization"**
   - **Policy name**: `Allow public to read avatars`
   - **Allowed operation**: âœ… `SELECT`
   - **Policy definition**:
     ```sql
     bucket_id = 'avatars'::text
     ```
   - ç‚¹å‡» **"Review"** â†’ **"Save policy"**

4. **åˆ›å»ºåˆ é™¤ç­–ç•¥ï¼ˆDelete Policyï¼‰** - å¯é€‰
   - ç‚¹å‡» **"New Policy"** â†’ **"For full customization"**
   - **Policy name**: `Allow users to delete their own avatars`
   - **Allowed operation**: âœ… `DELETE`
   - **Policy definition**:
     ```sql
     (bucket_id = 'avatars'::text) AND (auth.role() = 'authenticated'::text)
     ```
   - ç‚¹å‡» **"Review"** â†’ **"Save policy"**

---

#### æ–¹æ³• Bï¼šä½¿ç”¨ SQL åˆ›å»ºç­–ç•¥ï¼ˆæ›´å¿«ï¼‰

åœ¨ Supabase Dashboard çš„ **SQL Editor** ä¸­æ‰§è¡Œä»¥ä¸‹ SQLï¼š

```sql
-- å…è®¸å·²ç™»å½•ç”¨æˆ·ä¸Šä¼ å¤´åƒ
CREATE POLICY "Allow authenticated users to upload avatars"
ON storage.objects
FOR INSERT
TO authenticated
WITH CHECK (bucket_id = 'avatars');

-- å…è®¸æ‰€æœ‰äººæŸ¥çœ‹å¤´åƒï¼ˆå…¬å¼€è®¿é—®ï¼‰
CREATE POLICY "Allow public to read avatars"
ON storage.objects
FOR SELECT
TO public
USING (bucket_id = 'avatars');

-- å…è®¸å·²ç™»å½•ç”¨æˆ·åˆ é™¤è‡ªå·±çš„å¤´åƒï¼ˆå¯é€‰ï¼‰
CREATE POLICY "Allow users to delete their own avatars"
ON storage.objects
FOR DELETE
TO authenticated
USING (bucket_id = 'avatars');
```

---

## ğŸ¨ åŠŸèƒ½è¯´æ˜

### 1. å¤´åƒä¸Šä¼ 

**ä½¿ç”¨æ–¹æ³•ï¼š**
1. ç™»å½•åè¿›å…¥ä¸ªäººä¸­å¿ƒ
2. é¼ æ ‡æ‚¬åœåœ¨å¤´åƒä¸Šï¼Œä¼šå‡ºç° "ğŸ“· ä¸Šä¼ å¤´åƒ" æŒ‰é’®
3. ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼ˆæ”¯æŒ JPGã€PNGã€WEBPï¼‰
4. è‡ªåŠ¨ä¸Šä¼ å¹¶æ›´æ–°å¤´åƒ

**é™åˆ¶ï¼š**
- æ–‡ä»¶æ ¼å¼ï¼šJPGã€PNGã€WEBP
- æ–‡ä»¶å¤§å°ï¼šæœ€å¤§ 2MB
- è‡ªåŠ¨è¦†ç›–æ—§å¤´åƒ

---

### 2. ä¿®æ”¹å¯†ç 

**ä½¿ç”¨æ–¹æ³•ï¼š**
1. ç™»å½•åè¿›å…¥ä¸ªäººä¸­å¿ƒ
2. ç‚¹å‡» "è´¦æˆ·è®¾ç½®" æ ‡ç­¾é¡µ
3. ç‚¹å‡» "ä¿®æ”¹å¯†ç " æŒ‰é’®
4. è¾“å…¥åŸå¯†ç ã€æ–°å¯†ç ã€ç¡®è®¤æ–°å¯†ç 
5. ç‚¹å‡» "ç¡®è®¤ä¿®æ”¹"

**éªŒè¯è§„åˆ™ï¼š**
- éªŒè¯åŸå¯†ç æ˜¯å¦æ­£ç¡®
- æ–°å¯†ç é•¿åº¦è‡³å°‘ 6 ä½
- æ–°å¯†ç ä¸èƒ½ä¸åŸå¯†ç ç›¸åŒ
- ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç å¿…é¡»ä¸€è‡´

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æµ‹è¯•å¤´åƒä¸Šä¼ 

```bash
npm run dev
```

1. è®¿é—® `http://localhost:5173/#/profile`
2. ç™»å½•è´¦å·
3. é¼ æ ‡æ‚¬åœåœ¨å¤´åƒä¸Šï¼Œç‚¹å‡» "ä¸Šä¼ å¤´åƒ"
4. é€‰æ‹©ä¸€å¼ å›¾ç‰‡ï¼ˆ< 2MBï¼‰
5. æŸ¥çœ‹å¤´åƒæ˜¯å¦æˆåŠŸæ›´æ–°

**å¦‚æœå¤±è´¥ï¼š**
- æ£€æŸ¥æ˜¯å¦åˆ›å»ºäº† `avatars` å­˜å‚¨æ¡¶
- æ£€æŸ¥å­˜å‚¨æ¡¶æ˜¯å¦è®¾ç½®ä¸º **Public**
- æ£€æŸ¥æ˜¯å¦é…ç½®äº†è®¿é—®ç­–ç•¥

---

### æµ‹è¯•ä¿®æ”¹å¯†ç 

1. è®¿é—® `http://localhost:5173/#/profile`
2. ç™»å½•è´¦å·
3. ç‚¹å‡» "è´¦æˆ·è®¾ç½®" â†’ "ä¿®æ”¹å¯†ç "
4. è¾“å…¥åŸå¯†ç å’Œæ–°å¯†ç 
5. ç‚¹å‡»ç¡®è®¤ä¿®æ”¹
6. é€€å‡ºç™»å½•ï¼Œç”¨æ–°å¯†ç é‡æ–°ç™»å½•

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: ä¸Šä¼ å¤´åƒæ—¶æç¤º "ä¸Šä¼ å¤±è´¥"

**åŸå› ï¼š**
- æœªåˆ›å»º `avatars` å­˜å‚¨æ¡¶
- å­˜å‚¨æ¡¶æœªè®¾ç½®ä¸º Public
- æœªé…ç½®è®¿é—®ç­–ç•¥

**è§£å†³æ–¹æ³•ï¼š**
æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤ 1 å’Œæ­¥éª¤ 2 åˆ›å»ºå­˜å‚¨æ¡¶å’Œç­–ç•¥ã€‚

---

### Q2: å¤´åƒä¸Šä¼ æˆåŠŸä½†æ— æ³•æ˜¾ç¤º

**åŸå› ï¼š**
- å­˜å‚¨æ¡¶æœªè®¾ç½®ä¸º Public
- ç¼ºå°‘è¯»å–ç­–ç•¥

**è§£å†³æ–¹æ³•ï¼š**
1. è¿›å…¥ Storage â†’ Buckets â†’ avatars
2. ç‚¹å‡»å³ä¸Šè§’ **Settings**
3. ç¡®ä¿ **Public bucket** å·²å‹¾é€‰
4. æ·»åŠ è¯»å–ç­–ç•¥ï¼ˆå‚è€ƒæ­¥éª¤ 2ï¼‰

---

### Q3: ä¿®æ”¹å¯†ç æ—¶æç¤º "åŸå¯†ç é”™è¯¯"

**åŸå› ï¼š**
- è¾“å…¥çš„åŸå¯†ç ä¸æ­£ç¡®
- ç”¨æˆ·ä½¿ç”¨ OTP æ³¨å†Œï¼Œæœªè®¾ç½®è¿‡å¯†ç 

**è§£å†³æ–¹æ³•ï¼š**
å¦‚æœæ˜¯ OTP æ³¨å†Œçš„ç”¨æˆ·é¦–æ¬¡è®¾ç½®å¯†ç ï¼Œå¯ä»¥å…ˆé€šè¿‡ "å¿˜è®°å¯†ç " åŠŸèƒ½é‡ç½®å¯†ç ã€‚

---

## ğŸ“‹ å®Œæ•´åŠŸèƒ½æ¸…å•

- âœ… ç”¨æˆ·æ³¨å†Œï¼ˆéªŒè¯ç æ–¹å¼ï¼‰
- âœ… ç”¨æˆ·ç™»å½•ï¼ˆå¯†ç æ–¹å¼ï¼‰
- âœ… ç”¨æˆ·ç™»å‡º
- âœ… ä¸ªäººä¿¡æ¯ç¼–è¾‘ï¼ˆç”¨æˆ·åã€æ‰‹æœºå·ã€åœ°å€ï¼‰
- âœ… **å¤´åƒä¸Šä¼ **ï¼ˆæ–°å¢ï¼‰
- âœ… **ä¿®æ”¹å¯†ç **ï¼ˆæ–°å¢ï¼‰
- âœ… é‚®ç®±éªŒè¯ç å‘é€
- âœ… éªŒè¯ç éªŒè¯

---

## ğŸ‰ æ€»ç»“

ç°åœ¨ä½ çš„é¡¹ç›®å·²ç»æ”¯æŒï¼š
1. **å¤´åƒä¸Šä¼ **ï¼šé¼ æ ‡æ‚¬åœå¤´åƒå³å¯ä¸Šä¼ 
2. **ä¿®æ”¹å¯†ç **ï¼šåœ¨è´¦æˆ·è®¾ç½®ä¸­ä¿®æ”¹
3. **ä¸ªäººä¿¡æ¯ç®¡ç†**ï¼šç¼–è¾‘ç”¨æˆ·åã€æ‰‹æœºå·ã€åœ°å€

**ä¸‹ä¸€æ­¥ï¼š**
è¯·æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤åœ¨ Supabase Dashboard ä¸­åˆ›å»º `avatars` å­˜å‚¨æ¡¶ï¼Œç„¶åå°±å¯ä»¥æµ‹è¯•å¤´åƒä¸Šä¼ åŠŸèƒ½äº†ï¼
