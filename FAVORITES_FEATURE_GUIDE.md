# 🎨 刺绣作品收藏功能使用指南

## ✨ 功能概述

用户可以收藏喜欢的刺绣作品，并在个人中心的"我的收藏"中查看和管理。

---

## 📋 功能列表

### 1. **收藏刺绣作品**
- 在首页"精选刺绣"卡片上，鼠标悬停显示收藏按钮
- 点击 🤍 按钮收藏作品
- 收藏成功后按钮变为 ❤️ 红心

### 2. **查看收藏列表**
- 登录后访问个人中心
- 点击"我的收藏"标签页
- 查看所有已收藏的刺绣作品

### 3. **取消收藏**
- 在精选刺绣卡片上点击 ❤️ 取消收藏
- 或在"我的收藏"页面，点击右上角 ✕ 删除

---

## 🗂️ 技术实现

### 数据库表结构

```sql
CREATE TABLE favorites (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  product_id TEXT NOT NULL,
  created_at TIMESTAMP,
  UNIQUE(user_id, product_id)
);
```

### 核心文件

1. **`src/services/favorites.ts`** - 收藏服务
   - `addFavorite()` - 添加收藏
   - `removeFavorite()` - 取消收藏
   - `toggleFavorite()` - 切换收藏状态
   - `isFavorited()` - 检查是否已收藏
   - `getUserFavorites()` - 获取用户收藏列表

2. **`src/components/FeaturedProducts.vue`** - 精选刺绣组件
   - 显示收藏按钮
   - 处理收藏/取消收藏交互

3. **`src/views/ProfileView.vue`** - 个人中心
   - "我的收藏"标签页
   - 显示收藏列表
   - 管理收藏

4. **`src/stores/catalog.ts`** - 产品目录 Store
   - 新增 `allProducts` getter
   - 提供产品数据

---

## 🎨 样式特性

### 收藏按钮
- 默认透明，鼠标悬停显示
- 未收藏：白色心形 🤍
- 已收藏：红色心形 ❤️
- 悬停时放大动画

### 收藏列表
- 网格布局，响应式设计
- 悬停卡片上浮效果
- 删除按钮仅悬停时显示

---

## 🧪 测试步骤

### 1. 测试收藏功能

```bash
# 启动项目
npm run dev
```

1. 访问 `http://localhost:5173`
2. 注册/登录账号
3. 滚动到"精选刺绣"部分
4. 鼠标悬停任意刺绣卡片
5. 点击 🤍 收藏按钮
6. 看到提示"收藏成功"，按钮变为 ❤️

### 2. 测试收藏列表

1. 点击右上角头像进入个人中心
2. 点击"我的收藏"标签页
3. 看到已收藏的刺绣作品
4. 鼠标悬停任意作品，右上角显示 ✕
5. 点击 ✕ 取消收藏
6. 确认收藏已移除

### 3. 测试边界情况

- **未登录时收藏**：显示"请先登录"
- **重复收藏**：显示"已经收藏过该商品"
- **空收藏列表**：显示"暂无收藏内容"

---

## 🔧 数据库配置

收藏表已通过 migration 自动创建，包含：

✅ RLS 安全策略  
✅ 用户隔离（只能查看自己的收藏）  
✅ 唯一性约束（防止重复收藏）  
✅ 级联删除（用户删除时清理收藏）

---

## 📊 数据流

```
用户点击收藏按钮
    ↓
调用 toggleFavorite(productId)
    ↓
判断当前收藏状态
    ├─ 未收藏 → addFavorite()
    └─ 已收藏 → removeFavorite()
    ↓
更新本地收藏状态
    ↓
刷新 UI（❤️ / 🤍）
```

---

## 🎯 功能亮点

1. **实时同步** - 收藏状态实时更新到数据库
2. **权限控制** - 通过 RLS 确保数据安全
3. **用户体验** - 平滑动画，直观反馈
4. **数据一致性** - 防止重复收藏
5. **响应式设计** - 适配各种屏幕尺寸

---

## 🚀 未来扩展

可以考虑添加：

- 📊 收藏统计（收藏次数、热门作品）
- 🔔 收藏通知（降价提醒）
- 🏷️ 收藏分类（按类型、价格）
- 📤 分享收藏列表
- 📈 收藏趋势分析

---

## 💡 开发建议

### 如果需要修改收藏逻辑

1. 编辑 `src/services/favorites.ts`
2. 修改对应函数的实现
3. 重启开发服务器测试

### 如果需要调整样式

- 精选刺绣收藏按钮：`src/styles/main.scss` → `.favorite-btn`
- 收藏列表样式：`src/views/ProfileView.vue` → `<style>` 部分

---

## ✅ 完成清单

- [x] 创建 Supabase 收藏表
- [x] 实现收藏服务（favorites.ts）
- [x] 在精选刺绣添加收藏按钮
- [x] 在个人中心添加收藏标签页
- [x] 添加收藏样式和动画
- [x] 测试所有功能

---

**现在你可以开始使用收藏功能了！** 🎉
